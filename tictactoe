#!/usr/bin/env ruby

require_relative "./controllers/GameController.rb"
require_relative "./models/game-setup.rb"
require_relative "./gamestats.rb"
require "tty-prompt"
require "tty-file"
require "tty-table"
require "colorize"

####################################################################################
##########################         START THE GAME         ##########################
####################################################################################

# Check command-line arguments
showhelp()		if ["--h", "-h", "--help", "-help"].include? ARGV[0]
showversion()	if ["--v", "-v", "--ver", "-ver", "--version", "-version"].include? ARGV[0]
showabout()		if ["--a", "-a", "--about", "-about"].include? ARGV[0]
(ARGV[1].nil? ? gamestats() : gamestats(ARGV[1])) 	if ["--gs", "-stats", "--gamestats", "-gs", "--stats", "-gamestats"].include? ARGV[0]

if not ARGV[0]
	# Show title screen
	showtitlescreen(displayboard())

	# Initialise variables
	prompt = TTY::Prompt.new(symbols: {marker: " "})
	halign = 95

	# Ask for user prompt
	begin
		puts "\n"
		
		choices = 
		{
			"New Game".center(halign)				=> 1,
			"Simulation Mode".center(halign)		=> 2,
			"Instructions".center(halign)			=> 3,
			"Load Previous Games".center(halign)	=> 4,
			"Quit Game".center(halign)				=> 5
		}
		
		request = prompt.select("Choose from below: (Use ↑↓ arrow keys to select)\n".center(halign), choices, show_help: :never, cycle: true)
		GameController::create          if request == 1
		GameController::simulation      if request == 2
		GameController::instructions    if request == 3
		GameController::load_games      if request == 4
		request = prompt.select("Are you sure you want to quit?\n".center(halign), {"Yes".center(halign)=>0, "No".center(halign)=>5}, show_help: :never, cycle: true) if request == 5
	end until request == 0

	# End of game
	puts "\n\n"
	puts "Goodbye!".center(halign)
	puts "\n\n"
end
